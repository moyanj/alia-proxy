# 日志管理

`aiprox` 的日志系统是您排查问题、审计合规和收集数据最得力的助手。它不仅记录了元数据，还完整保存了对话内容。

## 日志列表与筛选

在“日志”页面，您可以浏览所有历史请求。

- **筛选器**:
    - **提供商**: 按 `openai-main`, `anthropic-backup` 等实例筛选。
    - **模型**: 支持模糊搜索，例如输入 `gpt-4` 可匹配所有相关模型。
    - **状态码**: 快速查找失败的请求（如输入 `500`）。
- **列表信息**: 展示时间、模型、端点、Token 消耗（Prompt/Completion/Total）和状态码。

## 日志详情

点击任意一条日志，侧边栏会滑出详细信息面板。

### 1. 对话内容还原
- **富文本展示**: 系统会解析 JSON 格式的 messages，将其渲染为易读的对话气泡。
- **多模态支持**:
    - **图片**: 如果请求中包含图片（即使是 Base64 上传的），这里会直接显示图片预览（基于本地存储的引用）。
    - **音频**: TTS 请求生成的音频文件可以直接在这里点击播放。
- **Markdown 渲染**: 模型的回复内容支持 Markdown 渲染（代码高亮、表格等）。
- **Raw 模式**: 点击切换按钮，可以查看原始的 JSON 响应体，方便调试字段级问题。

### 2. 元数据面板
- **基础信息**: Request ID, Log ID, 时间戳。
- **性能**: 完整的请求延迟（Latency）。
- **消耗**: 精确的 Prompt Tokens 和 Completion Tokens 统计。
- **客户端**: 发起请求的 IP 地址。

## 数据导出 (ShareGPT)

这是为模型微调（Fine-tuning）用户设计的杀手级功能。

在日志列表页右上角，点击“导出数据”，选择 **ShareGPT** 格式。

- **功能**: 系统会将筛选出的日志自动转换为 ShareGPT 兼容的 JSONL 格式。
- **用途**: 下载后的文件可以直接作为数据集，用于训练或微调 Llama 3, Mistral 等开源模型，无需繁琐的数据清洗和格式转换。
- **其他格式**: 也支持导出为标准 CSV 或原始 JSONL 用于通过 Excel 或 pandas 进行分析。
